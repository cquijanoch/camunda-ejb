<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="org.unsa.mybatis.mapper.BandejaDigaMapper">


	<insert id="save" parameterType="org.unsa.mybatis.bean.BandejaDiga">
		insert into bandeja_diga (id_bandeja_mesa, estado)
		values (#{bandejaMesaId}, #{estado})
	</insert>
	
	<select id="getAll" resultType="org.unsa.mybatis.bean.BandejaDiga">
		SELECT  bm.id_bandeja_mesa bandejaMesaPartesId, 
				bd.estado estado,
				bm.estado bandejaMesaPartesEstado,
				bm.detalle bandejaMesaPartesDetalle,
				r.id_requerimiento requerimientoId,
				r.asunto requerimientoAsunto,
				u.id_usuario usuarioId,
				u.nombre usuarioNombre,
				u.dni usuarioDni				
		 
		FROM usuario u 
		INNER JOIN requerimiento r
		ON u.id_usuario = r.id_usuario
		INNER JOIN bandeja_mesa_partes bm
		ON r.id_requerimiento = bm.id_requerimiento
		INNER JOIN bandeja_diga bd
		ON bm.id_bandeja_mesa =bd.id_bandeja_mesa
	</select>

</mapper>